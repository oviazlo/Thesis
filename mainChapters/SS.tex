\chapter{Searches for beyond Standard Model physics with same-sign dileptons}
\label{chap:SS}
\section{Motivation}
% ******************************************************************************
% TODO
% - write something about lepton signature... why it has benefits wrt to jets and photons...
% - write which models we are looking for. how signal looks like with comparison with background
% - write about benefits of the general search (or model-independent? or it's dangerous to say like this?)... theorists can use these results for their models?
% - motivation flow: why leptons -> why same-sign dilepton -> why model-independent search?
% ******************************************************************************

The idea of the current analysis is to make a general search for a new physics in a same-sign dilepton channel. \toFix
% Why do we use leptons as final objects?
Leptons as a physics signature are very clean and straighforward observalbles. 
ATLAS detector capable to detect leptons with amazing momentum resolution precision... \toFix[show some resolution plot]

In resonant searches for new physics using leptons are beneficial due to fact that resonance peak for potential BSM signals will be narrower with compariosn to e.g. using jets.
Because energy of leptons is reconstructed very well resonance peaks 
BSM bosons whose decay would manifest itself as a narrow resonance in the dilepton mass spectrum

% Why do we use same-sign dilepton channel
Looking for a same-sign dilepton channel is motivated by the fact that cross section for SM processes with such signature are really small, which make 
it very sensitive possible signals of new physics.  \toFix
% Why model-independent search
There are other searches in ATLAS which taget the same final signature but with requiring additional cuts on number of jets \toFix[link] of missing transverse energy \toFix[link].
In such way these analyses target limited number of specific models.
Analyses presented in this chapter aims to be more general and model-independent. 
\toFix[Explain which models does this analysis cover?]

\section{Background processes}
\label{sec:wprimeBackgrounds}
% ******************************************************************************
% TODO
% - describe that there are hree possibilities to reconstruct same-sign lepton pair
% - 
% ******************************************************************************


There are three different components which contribute to the signal selection.
The first component is so called prompt contribution when same-sign dilepton originates from the SM processes.
Just a few SM processes contribute to the same-sign dilepton final state. In such processes same-sign leptons originates from semi-weakly decay of top quark
and/or leptonic decays of $W, Z$ bosons. Some example of the Feynman diagrams are shown in \FigureRef{fig:Diboson_feynman}.
Overall SM processes with same-sign dilepton final state have relatively small cross section.

The second component comes from the wrong reconstruction of the lepton itself, when pion or jet is reconstructed as a lepton or from leptons which were born 
not in the pp collision but from decays of secondary particles, e.g. kaons. This component is called non-prompt or fake component.

The third component comes from misidentification of the electrical charge of the lepton, which make processes, where opposing lepton pair is produced, 
contribute to the signal selection as well. The charge misidentification effect become visible for high-momentum leptons, when curvature of the track 
is hard to reconstruct.

% TODO describe connection of written above with table with all used MC samples...
% TODO normalization is just checked for it is not applied as a scale factor. Cross check with Monika!!!
Prompt contribution is described by the MC simulation. 
% with applying the overall normalization of the MC samples to the data in the control region.
Non-prompt contribution is derived with the data-driven method, so called fake factor method.
Charge flip rate is estimated from Z boson lepton decays and is applied to the opposite-sign MC samples.

List of all used MC samples are shown in \TableRef{tab:MC_cross}. All other processes which are not listed in the table don't contribute
significantly to the same-sign selection and are considered negligable.

\begin{table}[ht]
  \begin{center}
    \begin{tabular}{l|c|c|c}

      \hline
Process &  Generator&  PDF set & Normalisation \\
&  + fragmentation/ &  & based on \\
&  hadronisation & &\\
\hline\hline
\multirow{2}{*}{$WZ$ } &  \multirow{2}{*}{{\scshape sherpa-1.4.1} \cite{Sherpa}} &   \multirow{2}{*}{CT10 \cite{ct10}} & NLO QCD \\
 & & &  with {\scshape mcfm-6.2}\cite{mcfm} \\
\hline
\multirow{2}{*}{$ZZ$}  &  \multirow{2}{*}{{\scshape sherpa-1.4.1}} & \multirow{2}{*}{CT10} & NLO QCD  \\
& & &  with {\scshape mcfm}-6.2 \\
\hline
\multirow{2}{*}{\Wpm\Wpm}  & M{\scshape ad}G{\scshape raph}-5.1.4.8 \cite{madgraph4}  &   \multirow{2}{*}{CTEQ6L1 \cite{cteq}}  &  \multirow{2}{*}{LO QCD} \\
&  {\scshape pythia-8.165} \cite{pythia8}& &\\
\hline
\ttbar $V$, & M{\scshape ad}G{\scshape raph}-5.1.4.8  & \multirow{2}{*}{CTEQ6L1} & \multirow{2}{*}{NLO QCD \cite{top9,ttbarW}} \\
$V=W,Z$ &  + {\scshape pythia-6.426} & & \\
\hline
 MPI $VV$ &  \multirow{2}{*}{{\scshape pythia-8.165}\cite{pythia8}}  &  \multirow{2}{*}{CTEQ6L1} &  \multirow{2}{*}{LO QCD} \\
 $V=W,Z$ &  & & \\[+0.025in]
\hline
\hline
\multirow{2}{*}{$Z/\gamma^* +$ jets} & {\scshape alpgen-2.14} \cite{Alpgen}&\multirow{2}{*}{CTEQ6L1}& {\scshape dynnlo-1.1} \cite{dynnlo} with \\
 & + {\scshape herwig-6.520} \cite{Herwig1, Herwig2}& & MSTW2008 NNLO \cite{mstw} \\
\hline
\multirow{2}{*}{\ttbar} & {\scshape mc@nlo}-4.06 \cite{Mcnlo, Mcnlo2} & \multirow{2}{*}{CT10}&{NNLO+NNLL } \\
& + {\scshape herwig-6.520} & & QCD \cite{top1,top2,top3,top4,top5,top6} \\
\hline
\multirow{2}{*}{$Wt$} & {\scshape mc@nlo-4.06}  & \multirow{2}{*}{CT10}& {NNLO+NNLL } \\
   & + {\scshape herwig-6.520} & & QCD \cite{top7,top8}\\
\hline
\multirow{2}{*}{$W^{\pm}W^{\mp}$} & \multirow{2}{*}{{\scshape sherpa-1.4.1}} & \multirow{2}{*}{CT10}& NLO QCD \\
& &  & with {\scshape mcfm-6.2}\\
\hline
\multirow{2}{*}{$W\gamma$} & \multirow{2}{*}{{\scshape sherpa}-1.4.1} & \multirow{2}{*}{CT10}& NLO QCD\\
& &  & with {\scshape mcfm-6.3}\\
\hline
\end{tabular}
\end{center}
  \caption{Generated samples used for background estimates. The generator, PDF set and order of cross-section calculations used for the normalisation
  are shown for each sample.
  The upper part of the table shows the MC samples used for the SM background coming from leptons with the same charge (MPI stands for multiple parton interactions), the lower part gives the background sources arising in the \ee\ or \emu\ channel due to electron charge misidentification.}
\label{tab:MC_cross}
\end{table}

\begin{figure}

\begin{subfigure}{.5\textwidth}
  \centering
  \includegraphics[width=\textwidth]{SS/feynman/WZ_electron_v2.eps}
\end{subfigure}%
\begin{subfigure}{.5\textwidth}
  \centering
  \includegraphics[width=\textwidth]{SS/feynman/ttbar_electron_v2.eps}
\end{subfigure}

\caption{Possible production diagrams for diboson (left) and $\ttbar W$ leading to same-sign dileptons. \toAsk[check diagrams]}
  \label{fig:precHitFracPerTrack}
\end{figure}


\section{Event selection}
% TODO mention here about size of the dataset and that it was 8 TeV 50 ns data.
% TODO description of the used triggers here!

% TODO ToTHINK MC cross section and sample sizes\toFix

Events of interest are events which have two high-$p_T$ isolated leptons \toFix

20.3 fb$^{-1}$ of data collected at 8 TeV center of mass energy pp collisions, with mean number of interactions per crossing equal to 21, 
with 50 ns bunch distance were used for the analysis.
Firstly events are required to have at least one reconstructed primary vertex with at least three tracks matched to it. If there are few vertices, the one with the highest
$\sum p^2_T$, where $p_T$ is transverse momenta of the tracks, is chosen.
Events which pass \toFix trigger, which selects events with two isolated \toFix leptons with $p_{T}>25$\toFix and $p_{T}>20$\toFix, were selected.
% TODO Cleaning and all other event-related cuts to describe here...

\subsection{Electron selection}
\label{subsec:electron_selection}

Electron candidates are reconstructed by matching of the track from ID with energy deposits in the EM calorimeter.

\toDo[explain how electron energy is measured]
\toDo[describe three chanels: ee, emu, mumu]

Electrons used for the signal selection are required to satisfy critereas:
\begin{itemize}
 \item $p_T > 20$ GeV. To ensure a high and flat trigger efficiency and to harmonize $p_T$ requirement between three analysis channels ($ee$, $\mu\mu$ and $e\mu$) 
 \item $|\eta|<2.47$ to be within high-granularity acceptance of EM calorimeter, but excluding barrel-end-cap transition region $1.37<|\eta|<1.52$.
 \item Transverse and longitudinal impact parameters $|d_0|/\sigma(d_0) < 3$ and $|z_0 \times sin \theta| < 1$ mm. 
 To verify that electron was born close to the primary vertex and to reject electrons which were originated from the decay of long-lived particles.
 \item To pass ``tight'' electron set of identification criterea defined in~\cite{electron_tight}. \\ 
 \toFix[explain shortly purpose of the cut]
 \item To pass isolation requirement. To distinguish prompt electrons from those associated with jet activity.
 \item No reconstructed jet within $\Delta R < 0.4$ \toFix[define R]. To remove ambiguous clasification of the track, when track is clasified as electron and as jet simultaneously. 
 Or when jet is too close to the electron which will lead to poor reconstruction of latter. 
\end{itemize}

Isolation requirement were chosen in order to reach pile-up independent efficiency of more than 99$\%$ for electrons 
with $p_T >$ 40 GeV. The requirement has two parts.
Firstly, the sum of the transverse energies in the EM and hadronic calorimeters around the electron within 
$\Delta R < 0.2$, with core electron energy subtracted from the sum, has to be less than 
3 GeV $+ (p_T^e - 20$ GeV$) \times 0.037$, where $p_T^e$ is electron transverse momentum.
Secondly, the sum of the $p_T$ of all tracks with $p_T > 0.4$ GeV within $\Delta R < 0.3$ around the electron track has
to be less than 10$\%$ of electron $p_T$.

Electrons used in control regions are required to fail one or few requirements above but pass looser one.

\subsection{Definition of same-sign electron pair}
% TODO inv. mass cut; treatment of event with three leptons;
All electrons which passed selection are considered while forming a lepton pair.
All combinations are checked and it is allowed to have more than one pair selected in one event.
Electrons in the pair are chatechorized by the $p_T$: electror with higher $p_T$ is called leading lepton, while another one with lower $p_T$ subleading lepton.
Leading lepton have to pass more strict cut $p_T>25$ GeV cut while subleading lepton have to satisfy $p_T>20$ GeV as described above.

If event contains an opposite-sign same flavour lepton pair which satisfies condition $( |m_{\Plepton\Plepton} - m_{Z}| < 10$ GeV$)$,
where $m_{\Plepton\Plepton}$ is lepton pair invariant mass and $m_{Z}$ is mass of Z boson, event is discarded.
This significantly suppress prompt background.

To avoid low-mass hadronic resonances like $J/\psi$ or $\varUpsilon$ to show up in the mass spectrum only same-sign pair with $m_{\Plepton\Plepton}>15$ GeV are selected.
Aditionaly, if same-sign lepton pair satisfies $70 < m_{\Plepton\Plepton}< 110$ GeV, which corresponds to the Z peak region, event is removed.
This region is used for estimation of the electron charge misidentification background.

\section{Estimation of the charge flip and non-prompt backgrounds}

\subsection{Prompt opposite-sign dilepton with charge flip}
% TODO
% subsection flow:
% CF sources --> method and used regions --> validation of the method --> deriving scale factors --> appling to specific MC samples
\toDo[description how charge flip rate was obtained, and plots if CF rate vs. pT and eta.]
\toAsk[why we define CF rate in 80..100 GeV region, while we cut 70..110 GeV from signal region?]
\toAsk[CF at high pT. extrapolation? of one large bin with huge error? look it up!]

Since the charge of one of the reconstructed electrons from the pair can be missidentified, 
opposite-sign dilepton final state processes can contribute as a background for the same-sign dilepton signal selection.
Because background is relatevily small in the signal selection a charge flip cannot be neglected and have to be properly estimated. Two cases are considered as a charge flip. When electron charge is actually misreconstructed due to matching of the wrong track to the EM cluster or by too small curvature of the high-momentum track. Or when electron emit a photon by bremsstrahlung, which decays to electron-positron pair. 

In order to estimate how many events with opposite-sign dileptons will ``leak'' to same-sign dilepton signal region one
need to know charge flip rate for electrons. It is expected that charge flip will depends from electron momentum (due to track curvature) and from $\eta$ (due to different geometry of the detector versus $\eta$).

Electrons from Z boson decay provide a great possibility to estimate charge flip rate. By applying signal selection
and requiring invariant mass of the lepton pair to be around Z mass, $80 < m_{ee} < 100$ GeV, one obtain a pure
sample of electron pairs, with one electron with missidentified charge. Knowing number of opposite- and same-sign
pairs one can extract charge flip rate.

In \FigureRef{fig:chargeFlip_structure} charge flip rate obtained from MC simulation as a function of $p_T$ is shown.
Contribution from photon conversion from bremsstrhulng process is shown separately. This contribution is dominant 
to charge flip rate over all $p_T$ range except high-$p_T$ region, where dominant effect become misreconstruction 
of charge due to very small curvature of tracks.

\toAsk[should I describe likelihood method?]

\begin{figure}
\begin{center}
 \includegraphics[width=0.7\columnwidth]{SS/support_note/chargeflip/misidratept_ZDY.eps}
\caption{\toDo[caption]}
\label{fig:chargeFlip_structure}
\end{center}
\end{figure}

To verify estimation of charge flip by MC simulation a special data-driven technique, so-called likelihood method, was used, which is described in~\cite{same_sign_paper_7tev}. To cross-check that applicability of the method it was used on 
MC simulation first and chrage flip rates were compared with the one from generator level (``truth'') information. 

Comparison demonstrates that likelihood method provide very reliable results as shown in
\FigureRef{fig:likelihood_cross_check}.

\begin{figure}
\begin{subfigure}{.5\textwidth}
  \centering
  \includegraphics[width=\textwidth]{SS/support_note/chargeflip/eta_mctruth.eps}
\end{subfigure}%
\begin{subfigure}{.5\textwidth}
  \centering
  \includegraphics[width=\textwidth]{SS/support_note/chargeflip/pt_mctruth.eps}
\end{subfigure}
\caption{\toDo}
\label{fig:likelihood_cross_check}
\end{figure}

Charge flip rate as a function of $p_T$ and $\eta$ is shown in \FigureRef{fig:charge_flip_data_vs_mc}.
Comparison between MC simulation and likelihood data-driven predictions are shown. 
Dependence of the rate as a function of $p_T$ is well described by MC simulation, while some difference can be observed
for high $\eta$ region. This is why $\eta$ dependent scale factors were obtained in order to correct MC prediction.

\begin{figure}
\begin{subfigure}{.5\textwidth}
  \centering
  \includegraphics[width=\textwidth]{SS/support_note/chargeflip/misidrate_datamc.eps}
\end{subfigure}%
\begin{subfigure}{.5\textwidth}
  \centering
  \includegraphics[width=\textwidth]{SS/support_note/chargeflip/misidratept_datamc.eps}
\end{subfigure}
\caption{\toDo}
\label{fig:charge_flip_data_vs_mc}
\end{figure}

For prediction of the charge flip in the signal region MC simulation of processes which produce opposite-sign pairs
were used (which are shown in \TableRef{tab:MC_cross}). Reconstructed same-sign lepton pairs were corrected by 
charge flip scale factor.

\subsection{Non-prompt background}
\toDo[short description of the fake factor method. Put details on which regions were used.]
\toDo[reference to Anthonys thesis]

Other background which is present after the signal selection is the so-called non-prompt background.
Main sources of this background are objects misidentified as electrons and electron born not close 
to the primary vertex, such as electrons from semi-leptonic decays of heavy flavor quarks ($b$, $c$)
To estimate this background a data-driven method, the so-called fake factor method, is used.

The idea of the method is following. 
First one need to define a background region, which will not overlap with the signal selection.
Contribution from prompt electrons in the background region have to be small and it should be enriched with
non-prompt electrons.
For this purpose a dijet data sample is used which contains strictly one reconstructed electron with $p_T > 20$ GeV
and a side away jet in the opposite azimuthal direction ($\Delta \phi (e,jet) > 2.4$).
By requiring strictly one electron one can make sure that background region will not overlap with the signal selection and processes like Drell-Yan and \ttbar will be supressed.
To make sure that away side jet and non-prompt electron are well balanced in terms of energy, away side jet is
requested to have $p_T < 30$ GeV.
To supress contribution from W boson production processes requirement on transverse invariant mass 
$m_\mathrm{T} > 40$ GeV is applied.
\footnote{$m_\mathrm{T} = \sqrt{2 p_\mathrm{T} E_\mathrm{T}^{miss} (1-\cos\varphi_{\Plepton\nu})}$, where
$p_\mathrm{T}$ is transverse momentum of the electron, $E_\mathrm{T}^{miss}$ is transverse missing energy of the event
and $varphi_{\Plepton\nu}$ is the angle between of them \toAsk[is it clear?].}

In this background region a fake factor $f$ is determined as:
\begin{equation}
f = \frac{N_{\mathrm{P}} - N_{\mathrm{P}}^{\mathrm{prompt}}}{N_{\mathrm{F}}  - N_{\mathrm{F}}^{\mathrm{prompt}}}.
\label{eq:fakefactor}
\end{equation}
where $N_{\mathrm{P}}$ is number of electron found in the background region which pass electron signal selection,
described before in \SectionRef{subsec:electron_selection} and $N_{\mathrm{F}}$ is number of electrons which do not meet 
signal electron selection but satisfy a less stringent one, where electron have to satisfy ``medium'' electron set of identification criterea~\cite{electron_tight} and to fail the calorimeter-based or track-based isolation requirement,
or both.
$N_{\mathrm{P}}^{\mathrm{prompt}}$ and $N_{\mathrm{F}}^{\mathrm{prompt}}$ are numbers of prompt
leptons, obtained from MC simulation, which pass signal and looser selections and have to be subtracted in order to make sure that fake factor was calculated with using only non-prompt electrons \toDo[weird phrasing, rewrite!].

Thanks to sufficiently large statistics of the background region the fake factor can be measured as a function of 
electrons $E_\mathrm{T}$ and $\eta$ with sufficient precition. 
Knowing fake factor one can calculate the total number of the events,
$N_{\mathrm{NP}}$, that contain same-sign lepton pairs which passed signal selection 
and have non-prompt:
\toAsk[is it good enough phrasing?]
\begin{equation}
N_{\mathrm{NP}} = \sum_{i}^{\mathrm{N_{P_l F_s}}} f_{\mathrm{s}}(p_{\mathrm{Ti}},|\eta_{i}|) + \sum_{i}^{\mathrm{N_{F_l P_s}}} f_{\mathrm{l}}(p_{\mathrm{T}i},|\eta_{i}|) - \sum_{i}^{\mathrm{N_{F_l F_s}}} f_{\mathrm{l}}(p_{\mathrm{T}i},|\eta_{i}|) \times f_{\mathrm{s}}(p_{\mathrm{T}i},|\eta_{i}|).
\label{eq:fake_pred}
\end{equation}
where the first term corresponds to the number of electron pairs ($N_{P_l F_s}$) 
where the leading electron (denoted by ``l'') passes selection criteria ($P_l$) and subleading electron 
(denoted by ``s'')
fails to fulfil it ($F_s$), but passes the looser selection used for fake factor calculation. 
Contribution of every such pair to the signal region is scaled by the fake factor 
$f_{\mathrm{s}}(p_{\mathrm{Ti}},|\eta_{i}|)$, where $p_\mathrm{Ti}$ and $\eta_{i}$ are transverse momentum and $\eta$
of the subleading electron from a pair which fails selection. 
Similarly, the second term represents number of pairs where
leading electron fails signal selection while the subleading passes it. 
The last term corresponds to the case when both leading
and subleading electrons fail signal selection. This term has to be subtracted from the sum to correct for the double
counting of non-prompt electrons.
\toAsk[is explanation above clear?]

The electron fake factor as a function of electrons $E_\mathrm{T}$ with statistical and systematic errors are
shown in \FigureRef{fig:ff_e_errs}. Derivation of the systematic errors is described in \SectionRef{???}.
\toDo[or should I describe them here???]
\begin{figure}[h]
\begin{center}
%\includegraphics[width=0.48\textwidth]{figures/electrons/electron-syst}
\includegraphics[width=0.65\textwidth]{SS/support_note/electrons/electron_fake_plot.eps}
\caption{Electron fake factor $f$ as a function of electron $E_\mathrm{T}$. Combined statistical and systematic errors shown with error bars.}
\label{fig:ff_e_errs}
\end{center}
\end{figure} 
\toDo[say that fake factors were also measured not only for signal selection, but also for less strong selections
which are used for fake validation regions].
\toAsk[what fake CR says us? we use different fake factors for them then for signal, so there is no direct relation?]

Verification of the fake factor method is done with help of validation region which are described further,


% The fake background includes all background processes where at least one of the leptons is fake. The dominant sources are $W$+jets and QCD multijets with smaller contributions arising from $Z$+jets and $t\bar{t}$. To assess this background, a data-driven method, known as the fake factor method, is employed. This method is used in several ATLAS analyses, particularly diboson measurements and searches\footnotemark. The method employed was covered in great depth in the previous 7 TeV incarnation of this analysis.

% \footnotetext{The following analyses, among others, use the fake factor method: SM $WW \ra \ell\nu\ell\nu$ and $WZ \ra \ell\nu\ell\ell$, $H \ra WW \ra \ell\nu\ell\nu$, and exotics $WZ \ra \ell\nu\ell\ell$ search.}

\section{Control regions}

In order to make sure that all backgrounds are modelled/estimated correctly in the signal region one can define and use special control (or validation) regions.
These regions have to have kinematics close to the one in the signal region but should not overlap with it. Each region is designed to test one given background type at a time,
which means that in each control region only one background type has to give dominant contribution with comparison to all other backgrounds.

\subsection{Prompt opposite-sign dilepton}

\subsection{Prompt same-sign enhanced control region}
% TODO table with final numbers to show how good MC normalization is wrt to data.

\subsection{Electron charge flip enhanced region}

\subsection{Fake-enriched region}
To verify the fake factor method, a set of validation regions is checked. 
These regions must satisfy the same requirements as
in signal selection except that either the isolation requirement must fail 
or the ``medium'' electron identification requirement has to be passed
but not ``tight'' (in order to not overlap with the signal region).
Non-prompt background is calculated in the same way as for the signal region, 
with the only difference that the fake factor used
in \EquationRef{eq:fake_pred} is obtained for the validation regions. 
\toAsk[phrasing?]

\begin{figure}[h]
\begin{center}
%\includegraphics[width=0.48\textwidth]{figures/electrons/electron-syst}
\includegraphics[width=0.7\textwidth]{SS/fake_regions_black_diagram.pdf}
\caption{\toDo}
\label{fig:fake_regions}
\end{center}
\end{figure}



\section{Signal Region}
\label{sec:wprimeSignalRegion}

\section{Systematic Uncertainties}
\label{sec:wprimeSystematics}
\subsection{Electron ID and momentum scale}
\subsection{Event-level and modelling systematics}
\subsection{Background uncertainty estimation}
\subsection{Systematic uncertainty on the signal}

\section{Cross section and mass limits}
\subsection{Statistical analysis for discovery and exclusion}
\subsection{Fiducial cross section limits on new physics}
\subsection{Mass limits on double charged Higgs}

\section{Outlook}
\label{sec:wprimeConclusion}

